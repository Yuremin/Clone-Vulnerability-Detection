static int CVE_2013_4534_VULN_openpic_load(QEMUFile* f, void *opaque, int version_id)
{

    OpenPICState *type2Clone_1 = (OpenPICState *)opaque;
    unsigned int i;

    if (version_id != 1) {
        return -EINVAL;
    }

    qemu_get_be32s(f, &type2Clone_1->gcr);
    qemu_get_be32s(f, &type2Clone_1->vir);
    qemu_get_be32s(f, &type2Clone_1->pir);
    qemu_get_be32s(f, &type2Clone_1->spve);
    qemu_get_be32s(f, &type2Clone_1->tfrr);

    qemu_get_be32s(f, &type2Clone_1->nb_cpus);

    for (i = 0; i < type2Clone_1->nb_cpus; i++) {
        qemu_get_sbe32s(f, &type2Clone_1->dst[i].ctpr);
        openpic_load_IRQ_queue(f, &type2Clone_1->dst[i].raised);
        openpic_load_IRQ_queue(f, &type2Clone_1->dst[i].servicing);
        qemu_get_buffer(f, (uint8_t *)&type2Clone_1->dst[i].outputs_active,
                        sizeof(type2Clone_1->dst[i].outputs_active));
    }

    for (i = 0; i < OPENPIC_MAX_TMR; i++) {
        qemu_get_be32s(f, &type2Clone_1->timers[i].tccr);
        qemu_get_be32s(f, &type2Clone_1->timers[i].tbcr);
    }

    for (i = 0; i < type2Clone_1->max_irq; i++) {
        uint32_t val;

        val = qemu_get_be32(f);
        write_IRQreg_idr(type2Clone_1, i, val);
        val = qemu_get_be32(f);
        write_IRQreg_ivpr(type2Clone_1, i, val);

        qemu_get_be32s(f, &type2Clone_1->src[i].ivpr);
        qemu_get_be32s(f, &type2Clone_1->src[i].idr);
        qemu_get_be32s(f, &type2Clone_1->src[i].destmask);
        qemu_get_sbe32s(f, &type2Clone_1->src[i].last_cpu);
        qemu_get_sbe32s(f, &type2Clone_1->src[i].pending);
    }

    return 0;

}