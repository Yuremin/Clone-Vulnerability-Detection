 */
static void CVE_2014_2289_VULN_copy_body_types(pjsip_rx_data *rdata,
			    struct exten_state_subscription *exten_state_sub)
{

	int i;
	pjsip_accept_hdr *type2Clone_1 = (pjsip_accept_hdr*)
		pjsip_msg_find_hdr(rdata->msg_info.msg, PJSIP_H_ACCEPT, NULL);

	exten_state_sub->body_types_count = type2Clone_1->count;
	exten_state_sub->body_types = ast_malloc(type2Clone_1->count * sizeof(char*));

	for (i = 0; i < type2Clone_1->count; ++i) {
		exten_state_sub->body_types[i] =
			ast_malloc(type2Clone_1->values[i].slen * sizeof(char*) + 1);

		ast_copy_string(exten_state_sub->body_types[i],
				pj_strbuf(&type2Clone_1->values[i]), type2Clone_1->values[i].slen + 1);
	}

}