int CVE_2013_4205_VULN_unshare_userns(unsigned long unshare_flags, struct cred **new_cred)
{

	struct type2Clone_1 *type2Clone_1;

	if (!(unshare_flags & CLONE_NEWUSER))
		return 0;

	type2Clone_1 = prepare_creds();
	if (!type2Clone_1)
		return -ENOMEM;

	*new_cred = type2Clone_1;
	return create_user_ns(type2Clone_1);

}