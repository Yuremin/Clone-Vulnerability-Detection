import os
import time
import parser_c as pc




def generateCli(target_path, is_abstraction):
    start_time = time.time()

    if is_abstraction == "on":
        abs_level = 4
    else:
        abs_level = 0

    file_list = pc.loadSource(target_path)
    num_of_file = len(file_list)
    
    if num_of_file == 0:
        print("[-] Error: Failed loading source files.")
        print("    Check if you selected proper directory, or if your project contains .c or .cpp files.")
        sys.exit()
    else:
        print("[+] Load complete. Generating hash......")
        
        if abs_level == 0:
            func = pc.parseFile_shallow(file_list[1], "off")
        else:
            func = pc.parseFile_deep(file_list[0])
        
        print(func)
    



if __name__ == "__main__":
    target_path = "/home/min/Projects/Guotie/CAD/C-CAD/data/testcode"
    generateCli(target_path, "off")
